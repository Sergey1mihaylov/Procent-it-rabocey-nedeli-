<!doctype html>
<html lang="ru">
<head>
<meta charset="utf-8"/>
<meta name="viewport" content="width=device-width,initial-scale=1"/>
<title>Рабочий прогресс</title>

<style>
  body{
    margin:0;
    font-family: -apple-system, BlinkMacSystemFont, Inter, Roboto;
    background:#0e111a;
    color:#e8eef5;
    padding:14px;
  }
  .block{
    background:#161b26;
    border:1px solid rgba(255,255,255,0.05);
    padding:14px;
    border-radius:10px;
    margin-bottom:12px;
  }
  h1{
    margin:0 0 10px;
    font-size:20px;
    font-weight:600;
  }
  .label{
    font-size:14px;
    color:#9aa2b3;
    margin-bottom:4px;
  }
  .big{
    font-size:32px;
    font-weight:700;
    text-align:right;
  }
  .row{
    display:flex;
    justify-content:space-between;
    font-size:14px;
    margin-top:6px;
    color:#9aa2b3;
  }
  .prog{
    height:12px;
    width:100%;
    background:#222836;
    border-radius:8px;
    overflow:hidden;
    margin-top:10px;
  }
  .bar{
    height:100%;
    width:0%;
    background:#4ade80;
    transition:width .3s;
  }
  footer{
    text-align:center;
    font-size:12px;
    color:#8590a3;
    margin-top:8px;
  }
</style>
</head>
<body>

<h1>Рабочий прогресс</h1>

<div class="block">
  <div class="label">Сегодня</div>
  <div id="dayPct" class="big">0%</div>
  <div class="prog"><div id="dayBar" class="bar"></div></div>
  <div class="row">
    <span id="dayStatus"></span>
    <span id="dayTime"></span>
  </div>
</div>

<div class="block">
  <div class="label">Неделя (Пн–Пт)</div>
  <div id="weekPct" class="big">0%</div>
  <div class="prog"><div id="weekBar" class="bar"></div></div>
  <div class="row">
    <span id="weekStatus"></span>
    <span id="weekTime"></span>
  </div>
</div>

<footer>Рабочее время: 09:45–19:05 (МСК)</footer>

<script>
(function(){
  // Настройки — твой график
  const START = {h:9, m:45};
  const END   = {h:19, m:5};
  const WORK_DAYS = 5; // Пн–Пт

  const dayPct = document.getElementById("dayPct");
  const dayBar = document.getElementById("dayBar");
  const dayStatus = document.getElementById("dayStatus");
  const dayTime = document.getElementById("dayTime");

  const weekPct = document.getElementById("weekPct");
  const weekBar = document.getElementById("weekBar");
  const weekStatus = document.getElementById("weekStatus");
  const weekTime = document.getElementById("weekTime");

  function toToday(t, base){
    const d = new Date(base);
    d.setHours(t.h, t.m, 0, 0);
    return d;
  }
  function secDiff(a,b){ return (b-a)/1000; }

  function human(sec){
    sec = Math.max(0, sec|0);
    const h = (sec/3600)|0;
    const m = ((sec%3600)/60)|0;
    if(h>0) return `${h}ч ${m}м`;
    return `${m}м`;
  }

  function compute(){
    const now = new Date();

    // Сегодняшний интервал
    let start = toToday(START, now);
    let end   = toToday(END, now);

    const workDaySec = secDiff(start, end);

    // Процент дня
    let elapsedTodaySec = 0;

    if(now < start){
      elapsedTodaySec = 0;
      dayStatus.textContent = "Ещё не началось";
    } else if(now > end){
      elapsedTodaySec = workDaySec;
      dayStatus.textContent = "Уже закончено";
    } else {
      elapsedTodaySec = secDiff(start, now);
      dayStatus.textContent = "В процессе";
    }

    const pctDay = Math.min(100, Math.max(0, (elapsedTodaySec/workDaySec)*100));
    dayPct.textContent = pctDay.toFixed(1) + "%";
    dayBar.style.width = pctDay + "%";
    dayTime.textContent = `${human(elapsedTodaySec)} / ${human(workDaySec)}`;

    // Неделя
    const jsDay = now.getDay(); // 0=Sun..6=Sat
    const dayIndex = (jsDay===0?6:jsDay-1); // Пн=0

    let elapsedWeekSec = 0;

    // Добавить прошлые полные рабочие дни
    for(let i=0;i<dayIndex;i++){
      if(i < WORK_DAYS) elapsedWeekSec += workDaySec;
    }
    // Добавить сегодня (только если сегодня рабочий день)
    if(dayIndex < WORK_DAYS){
      elapsedWeekSec += Math.min(elapsedTodaySec, workDaySec);
    }

    const totalWeekSec = workDaySec * WORK_DAYS;

    const pctWeek = (elapsedWeekSec / totalWeekSec)*100;
    weekPct.textContent = pctWeek.toFixed(1) + "%";
    weekBar.style.width = pctWeek + "%";

    weekStatus.textContent = pctWeek>=100 ? "Неделя завершена" : "Идёт";
    weekTime.textContent = `${human(elapsedWeekSec)} / ${human(totalWeekSec)}`;
  }

  compute();
  setInterval(compute, 1000);
})();
</script>

</body>
</html>
